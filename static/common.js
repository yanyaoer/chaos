// Generated by CoffeeScript 1.6.3
(function() {
  var $, moment;

  moment = require("moment");

  $ = require("jquery");

  window.get_timestamp_by_object_id = function(oid) {
    return Number('0x' + oid.substr(0, 8)) * 1000;
  };

  $(function() {
    var dropZone, dropfn, el, processFiles;
    el = $('#loading');
    $(document).ajaxStart(function() {
      return el.show();
    }).ajaxComplete(function() {
      return el.hide();
    });
    processFiles = function(event) {
      var f, files, i, reader, _results;
      event.stopPropagation();
      event.preventDefault();
      console.log(event);
      files = event.dataTransfer.files;
      i = 0;
      f = void 0;
      _results = [];
      while (f = files[i]) {
        reader = new FileReader();
        reader.onload = (function(file, index) {
          return function(e) {
            var dataUri, img, sel;
            dataUri = e.target.result;
            if (file.type.match("image.*")) {
              img = document.createElement('IMG');
              img.setAttribute('src', dataUri);
              img.setAttribute('title', file.name);
              sel = document.getSeletion();
              console.log(sel, img);
              if (sel.type === 'None') {
                return document.queryselector('.article-conent').appendChild(img);
              } else {
                return sel.getRangeAt(0).insertNode(img);
              }
            }
          };
        })(f, i);
        _results.push(i++);
      }
      return _results;
    };
    dropZone = document.getElementById("feed");
    console.log(dropZone, '===');
    dropfn = function(e) {
      e.stopPropagation();
      e.preventDefault();
      return console.log(e);
    };
    if (window.File && window.FileReader && window.FileList && window.Blob) {
      dropZone.addEventListener("drop", dropfn, false);
      console.log('init');
      return dropZone.addEventListener("dragenter", dropfn, false);
    } else {
      return console.log("The File APIs are not fully supported in this browser.");
    }
  });

}).call(this);

/*
//@ sourceMappingURL=common.map
*/
